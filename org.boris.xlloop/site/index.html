<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>XLLoop - Excel Functions in Java, Javascript, Ruby, Python</title>
		<link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon"/>
        <link rel="stylesheet" href="style.css" type="text/css" />
        <meta name="description" content="OOP Framework for Java"/>
        <meta name="keywords" content="java, excel, addin, xll, xloper"/>
        <meta http-equiv="pragma" content="no-cache"/>    
    </head>

    <body>

    <div id="heading">
        <div class="title"><img src="logo.gif"/>XLLoop</div>
        <div class="subtitle">Excel Functions in Java, Javascript, Ruby, Python</div>
    </div>
    
    <div class="content">

        <div class="section">
            <div class="section-title">About</div>
            <div class="section-content">
            	XLLoop is a framework for implementing a warehouse of excel functions out of 
            	process and has the following features:
            	<ul>
            	<li>Extensible <b>Java</b> server framework.</li>
            	<li>Extensible <b>Erlang</b> server framework.</li>
            	<li>Reflection-based function adaptor for extremely quick deployment of java methods.</li>
            	<li>Bean scripting framework adaptor so functions can be written in any BSF-supported language (eg. Ruby, Python, Javascript).</li>
            	<li>Lisp Function Handler for evaluating Lisp expressions on the fly.</li>
            	<li>Functions can be registered as excel functions (with help information).</li>
            	<li>Functions can be dynamically added to excel without restart.</li>
            	<li>Fast binary protocol.</li>
            	</ul> 
            	XLLoop consists of two main components:
            	<ul>
            	<li>An excel addin implementation (xll written in c++).</li>
            	<li>A server and framework written in java (and another written in <a href="erlangserver.html">erlang</a>).</li>
            	</ul>
            	The addin and server communicate via a simple socket-based protocol, sending and
            	receiving (binary) serialised xl objects (called xlopers).
            	<br/><br/>
                XLLoop is licensed under the <a href="http://www.eclipse.org/legal/cpl-v10.html">Common Public License (CPL)</a>.
            </div>
        </div>
        
		<div class="section">
			<div class="section-title">Download</div>
			<div class="section-content">
				The latest <a href="https://sourceforge.net/project/showfiles.php?group_id=222420">download</a> is available from the Project Page.
			</div>
		</div>
		
		<div class="section">
			<div class="section-title">Usage</div>
			<div class="section-content">
			An example of a very simple server that exposes the methods in the java.lang.Math class:
<pre>
package org.boris.xlloop.util;

import org.boris.xlloop.FunctionServer;
import org.boris.xlloop.reflect.ReflectFunctionHandler;

public class ServerExample {
    public static void main(String[] args) throws Exception {
        // Create function server on the default port
        FunctionServer fs = new FunctionServer();
        
        // Create a reflection function handler and add the Math methods
        ReflectFunctionHandler rfh = new ReflectFunctionHandler();
        rfh.addMethods("Math.", Math.class);
        
        // Create a function information handler to register our functions
        FunctionInformationRequestHandler firh = new FunctionInformationRequestHandler();
        firh.add(rfh.getFunctions());

        // Set the handlers
        fs.setRequestHandler(new DebugRequestHandler(firh));
        fs.setFunctionHandler(new DebugFunctionHandler(rfh));
        
        // Run the engine
        System.out.println("Listening on port 5454...");
        fs.run();
    }
}
</pre>
			This will expose all the java.lang.Math functions inside excel. Excel usage is as follows:
<pre>
=FS("Math.random")
=Math.random()

=FS("Math.sin", 3.14)
=Math.sin(3.14)

=FS("Math.pow", 2, 4.45)
=Math.pow(2, 4.45)
</pre>
			The addin can be customized using an INI file with the same name as the addin. Eg. (xlloop.ini). The INI file can accept the following settings:<br/><br/>
				<table>
					<tr><th>Key</th><th>Description</th></tr>
					<tr>
						<td>hostname</td>
						<td>This is the hostname of the server that the addin will connect to (default is localhost)</td>
					</tr>
					<tr>
						<td>port</td>
						<td>This is the port that the addin will connect to (default is 5454).</td>
					</tr>
					<tr>
						<td>addin.name</td>
						<td>This is the name that will appear in the Excel addin manager window (default is "XLLoop " + version).</td>
					</tr>
					<tr>
						<td>function.name</td>
						<td>This is the name of the function that will be registered in excel (default is "FS").</td>
					</tr>
					<tr>
						<td>include.volatile</td>
						<td>This is a switch to include a volatile version of the "FS" function.</td>
					</tr>
					<tr>
						<td>function.name.volatile</td>
						<td>This is the name of the volatile version of the function (default is "FSV").</td>
					</tr>
					<tr>
						<td>disable.function.list</td>
						<td>Set this to "true" to switch off static excel function registration.</td>
					</tr>
				</table>						
		</div>

		<div class="section">
			<div class="section-title">Javadoc</div>
			<div class="section-content">
				The javadoc for the server framework can be found <a href="/javadoc/index.html">here</a>.
			</div>
		</div>

		<div class="section">
			<div class="section-title">Lisp Example</div>
			<div class="section-content">
				The following page shows an <a href="lisphandler.html">example lisp function handler</a>.
			</div>
		</div>

		<div class="section">
			<div class="section-title">Bean Scripting Framework Support</div>
			<div class="section-content">
			The following example shows a server that exposes all scripts within a directory (and sub directories) as
			functions:
<pre>
package org.boris.functionserver;

import java.io.File;

import org.boris.functionserver.reflect.ReflectFunctionHandler;
import org.boris.functionserver.script.ScriptRepository;
import org.boris.functionserver.util.CompositeFunctionHandler;

public class ServerTest 
{
    public static void main(String[] args) throws Exception {
        FunctionServer fs = new FunctionServer();
        ReflectFunctionHandler rfh = new ReflectFunctionHandler();
        ScriptRepository srep = new ScriptRepository(new File("functions"), "Script.");
        rfh.addMethods("Math.", Math.class);
        CompositeFunctionHandler cfh = new CompositeFunctionHandler();
        cfh.add(rfh);
        cfh.add(srep);
        fs.setFunctionHandler(cfh);
        fs.run();
    }
}
</pre>
	An example script called "mult.js", written in javascript simply multiplies the two numbers entered:
<pre>
args[0] * args[1];
</pre>
	This can be called from Excel with the configuration above as follows:
<pre>
=FS("Script.mult", 45.3, 23)
=Script.mult(45.3, 23)
</pre>
			</div>
		</div>

		<div class="section">
			<div class="section-title">Useful Code</div>
			<div class="section-content">
				A C++ std::iostream implementation for windows socket can be found <a href="tcpstream.html">here</a>.
			</div>
		</div>
		
		<div class="section">
			<div class="section-title">Change History</div>
			<div class="section-content">
				V0.0.7
				<ul>
					<li>Added a <a href="erlangserver.html">server implementation in Erlang</a>.</li>
					<li>Added excel help text support for scripts</li>
					<li>Added CSV functions to example<li>
					<li>Added reflection functions to example<li>
					<li>Added javascript handler that compiles scripts</li>
				</ul>
				V0.0.6
				<ul>
					<li>Added lisp function handler example.</li>
					<li>Bug fix for returning empty collections.</li>
					<li>Refactoring package names to "xlloop" structure.</li>
				</ul>
				V0.0.5
				<ul>
					<li>Added ability to register functions as real excel functions (with associated help text).</li>
				</ul>
				V0.0.4
				<ul>
					<li>Improved marshalling of arrays and vectors.</li>
					<li>Added example server.</li>
					<li>Bug fixes.</li>
				</ul>
				V0.0.3
				<ul>
					<li>Java source changed to 1.4 compatibility.</li>
					<li>Included BSF jar in download.</li>
					<li>Bug fixes.</li>
				</ul>
				V0.0.2
				<ul>
					<li>Added support for BSF scripting.</li>
					<li>Bug fixes.</li>
				</ul>
				V0.0.1
				<ul>
					<li>Initial version.</li>
					<li>BSF integration not working yet.</li>
				</ul>
			</div>
		</div>		
    </div>
    
    <div id="footer">
        <p>
            <a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=222420&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
        </p>
    </div>
</body>
</html>