<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>XLLoop - Excel Functions in Java, Javascript, Ruby, Python, Erlang</title>
		<link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon"/>
        <link rel="stylesheet" href="style.css" type="text/css" />
        <meta name="description" content="OOP Framework for Java"/>
        <meta name="keywords" content="java, excel, addin, xll, xloper"/>
        <meta http-equiv="pragma" content="no-cache"/>    
    </head>

    <body>

    <div id="heading">
        <div class="title"><img src="logo.gif"/>XLLoop</div>
        <div class="subtitle">Excel Functions in Java, Javascript, Ruby, Python, Erlang</div>
    </div>
    
    <div class="content">

        <div class="section">
            <div class="section-title">About</div>
            <div class="section-content">
            <table style="border:0px">
            <tr style="border:0px">
            <td style="border:0px">
            	XLLoop is an open source framework for implementing excel functions on a centralised server 
            	(a function server).  
            	<br/><br/>
            	<i><b>Why is this useful?</b></i>
            	<ul>
            	<li>Functions can be written in any language (e.g. Java, scripting languages etc..)
            	<li>Functions can be added quickly and dynamically without users having to restart excel.
            	<li>Functions can be managed separately and centrally, which avoids the costly overhead of managing many XLLs and ensures
            	all users are using the same functions.
            	<li>Data can be shared across excel sessions/users (e.g. current stock market prices can
            	be stored on a single server and all excel sessions could retrieve this data via a <i>GetStock</i> function). 
            	</ul>
            	It has the following features:
            	<ul>
            	<li>Extensible <b>Java</b> server framework.</li>
            	<li>Native server frameworks written in many other languages (see <a href="#Languages">languages section</a>).</li>
            	<li><b>NEW - Popup for long running operations (with option to cancel)</b><li>
				<li>Support for hosting C++ XLLs via <b><a href="http://jxll.sourceforge.net">JXLL</a></b>.
            	<li>Reflection-based function adaptor for extremely quick deployment of java methods.</li>
            	<li>Bean scripting framework adaptor so functions can be written in any BSF-supported language (eg. Ruby, Python, Javascript).</li>
            	<li><a href="lisphandler.html">Lisp Function Handler</a> for evaluating Lisp expressions on the fly.</li>
            	<li>Functions can be registered as excel functions (with help information).</li>
            	<li>Functions can be dynamically added to excel without restart.</li>
            	<li>Fast binary protocol.</li>
            	</ul> 
            	XLLoop consists of two main components:
            	<ul>
            	<li>An excel addin implementation (xll written in c++).</li>
            	<li>A server and framework written in java (and in many other languages (see <a href="#Languages">languages section</a>)).</li>
            	</ul>
            	The addin and server communicate via a simple socket-based protocol, sending and
            	receiving (binary) serialised xl objects (called xlopers).
            	<br/><br/>
                XLLoop is licensed under the <a href="http://www.eclipse.org/legal/cpl-v10.html">Common Public License (CPL)</a>.
            </td>
            <td style="border:0px" valign="top">
            	<img src="diag.gif"/>
            </td>
            </tr>
            </table>
            </div>
        </div>
        
		<div class="section">
			<div class="section-title">Download</div>
			<div class="section-content">
				The latest <a href="https://sourceforge.net/project/showfiles.php?group_id=222420">download</a> is available from the Project Page.
			</div>
		</div>

		<div class="section">
			<div class="section-title"><a name="Languages"></a>Language Support</div>
			<div class="section-content">
				The following table summarizes the current support for different languages.<br/><br/>
				<table width="400">
					<tr><th>Language</th><th>Supported?</th></tr>
					<tr><td>Java</td><td>Yes, native server</td></tr>
					<tr><td>C++</td><td>Yes, via XLLServer (included in download)</td></tr>
					<tr><td>Erlang</td><td>Yes, <a href="erlangserver.html">native server</a></td></tr>
					<tr><td>Lisp</td><td><a href="lisphandler.html">Yes</a>, using <a href="http://jatha.sourceforge.net/">Jatha</a></td></tr>
					<tr><td>Ruby</td><td>Yes, a native <a href="rubyserver.html">ruby server</a> is included in the download.</td></tr>
					<tr><td>Python</td><td>Yes, a native <a href="pythonserver.html">python server</a> is included in the download.</td></tr>
					<tr><td>Javascript</td><td>Yes, using <a href="http://www.mozilla.org/rhino/">Rhino</a></td></tr>
					<tr><td>R</td><td>Yes, a native <a href="rserver.html">R server</a> is included in the download.</td></tr>
				</table>
			</div>
		</div>
		
		<div class="section">
			<div class="section-title">Usage</div>
			<div class="section-content">
			An example of a very simple server that exposes the methods in the java.lang.Math class:
<pre>
package org.boris.xlloop.util;

import org.boris.xlloop.FunctionServer;
import org.boris.xlloop.handler.*;
import org.boris.xlloop.reflect.*;

public class ServerExample
{
    private static final boolean LOAD_BALANCE = false;

    public static void main(String[] args) throws Exception {
        // Create function server on the default port
        FunctionServer fs = new FunctionServer();

        // Create a reflection function handler and add the Math methods
        ReflectFunctionHandler rfh = new ReflectFunctionHandler();
        rfh.addMethods("Math.", Math.class);
        rfh.addMethods("Math.", Maths.class);
        rfh.addMethods("CSV.", CSV.class);
        rfh.addMethods("Reflect.", Reflect.class);

        // Create a function information handler to register our functions
        FunctionInformationFunctionHandler firh = new FunctionInformationFunctionHandler();
        firh.add(rfh.getFunctions());

        // Create a function handler to demonstrate the "load balancing"
        // capability
        GetLoadServerFunctionHandler glsfh = new GetLoadServerFunctionHandler();

        // Set the handlers
        CompositeFunctionHandler cfh = new CompositeFunctionHandler();
        cfh.add(rfh);
        cfh.add(firh);
        if (LOAD_BALANCE)
            cfh.add(glsfh);
        fs.setFunctionHandler(new DebugFunctionHandler(cfh));

        // Run the engine
        System.out.println("Listening on port " + fs.getPort() + "...");
        fs.run();
    }
}
</pre>
			This will expose all the java.lang.Math functions inside excel. Excel usage is as follows:
<pre>
=FS("Math.random")
=Math.random()

=FS("Math.sin", 3.14)
=Math.sin(3.14)

=FS("Math.pow", 2, 4.45)
=Math.pow(2, 4.45)
</pre>
			The addin can be customized using an INI file with the same name as the addin. Eg. (xlloop.ini). The INI file can accept the following settings:<br/><br/>
				<table>
					<tr><th>Key</th><th>Description</th></tr>
					<tr>
						<td>hostname</td>
						<td>This is the hostname of the server that the addin will connect to (default is localhost)</td>
					</tr>
					<tr>
						<td>port</td>
						<td>This is the port that the addin will connect to (default is 5454).</td>
					</tr>
					<tr>
						<td>addin.name</td>
						<td>This is the name that will appear in the Excel addin manager window (default is "XLLoop " + version).</td>
					</tr>
					<tr>
						<td>function.name</td>
						<td>This is the name of the function that will be registered in excel (default is "FS").</td>
					</tr>
					<tr>
						<td>include.volatile</td>
						<td>This is a switch to include a volatile version of the "FS" function.</td>
					</tr>
					<tr>
						<td>function.name.volatile</td>
						<td>This is the name of the volatile version of the function (default is "FSV").</td>
					</tr>
					<tr>
						<td>disable.function.list</td>
						<td>Set this to "true" to switch off dynamic excel function registration.</td>
					</tr>
					<tr>
						<td>load.server.request</td>
						<td>Set this to "true" to enable this feature in the addin.</td>
					</tr>
					<tr>
						<td>disable.calc.popup</td>
						<td>Set this to "true" to disable the popup.</td>
					</tr>
					<tr>
						<td>disable.calc.cancel</td>
						<td>Set this to "true" to disable to 'click to cancel' feature.</td>
					</tr>
				</table>						
		</div>

		<div class="section">
			<div class="section-title">Javadoc</div>
			<div class="section-content">
				The javadoc for the server framework can be found <a href="/javadoc/index.html">here</a>.
			</div>
		</div>

		<div class="section">
			<div class="section-title">Popup For Long Running Operations</div>
			<div class="section-content">
				The following screenshot shows the popup in action:
				<br/><br/>
				<img src="busy.gif"/>
				<br/><br/>
				The popup will appear after receiving no response from the server for a couple of seconds.
				It will automatically disappear when the server responds. The user can click the
				popup to terminate the connection to the server (it will automatically reconnect on the
				next function call).
				<br/><br/>
				Note that this feature can be disabled via the INI file (see table above).
			</div>
		</div>

		<div class="section">
			<div class="section-title">Lisp Example</div>
			<div class="section-content">
				The following page shows an <a href="lisphandler.html">example lisp function handler</a>.
			</div>
		</div>

		<div class="section">
			<div class="section-title">Bean Scripting Framework Support</div>
			<div class="section-content">
			The following example shows a server that exposes all scripts within a directory (and sub directories) as
			functions:
<pre>
package org.boris.functionserver;

import java.io.File;

import org.boris.functionserver.reflect.ReflectFunctionHandler;
import org.boris.functionserver.script.ScriptRepository;
import org.boris.functionserver.util.CompositeFunctionHandler;

public class ServerTest 
{
    public static void main(String[] args) throws Exception {
        FunctionServer fs = new FunctionServer();
        ReflectFunctionHandler rfh = new ReflectFunctionHandler();
        ScriptRepository srep = new ScriptRepository(new File("functions"), "Script.");
        rfh.addMethods("Math.", Math.class);
        CompositeFunctionHandler cfh = new CompositeFunctionHandler();
        cfh.add(rfh);
        cfh.add(srep);
        fs.setFunctionHandler(cfh);
        fs.run();
    }
}
</pre>
	An example script called "mult.js", written in javascript simply multiplies the two numbers entered:
<pre>
args[0] * args[1];
</pre>
	This can be called from Excel with the configuration above as follows:
<pre>
=FS("Script.mult", 45.3, 23)
=Script.mult(45.3, 23)
</pre>
			</div>
		</div>

		<div class="section">
			<div class="section-title">Useful Code</div>
			<div class="section-content">
				A C++ std::iostream implementation for windows socket can be found <a href="tcpstream.html">here</a>.
			</div>
		</div>
		
		<div class="section">
			<div class="section-title">Change History</div>
			<div class="section-content">
				V0.2.0
				<ul>
				<li>Added popup to client for long running operations (with option to cancel request)</li>
				<li>Added native Ruby server</li>
				<li>Added native Python server</li>
				<li>Added native R server</li>
				<li>Fixed native Erlang server</li>
				<li>Buffered streams on java server for improved performance</li>
				<li>Improvements to reliability on binary protocol</li>
				<li>Support up to 512 registered functions</li>
				<li>Reduced xll size by using wcrt</li>
				</ul>
				V0.1.0
				<ul>
					<li>Refactored protocol to directly marshal xloper objects</li>
					<li>FunctionServer can now return excel errors, integers and booleans.</li>
					<li>Added support for C++ via <b><a href="http://jxll.sourceforge.net">JXLL</a></b>.</li>
					<li>New demo, XLLServer, loads and exposes functions from other XLLs.</li>
					<li>Note: Erlang server not currently supported due to change in protocol. This is TBD.</li>
					<li>Included a CSV reader utility for function information.</li>
				</ul>
				
				<a href="oldchangehistory.html">Older Change History</a>
				<br/><br/>
			</div>
		</div>		
    </div>
    
    <div id="footer">
		<div class="footer"/>
		<table style="border:0px;width:750px">
		<tr style="border:0px;vertical-align:top">
		<td style="border:0px;vertical-align:top;width:619px">
        <a href="http://www.opensource.org/docs/definition.php"><img border="0" alt="Open Source" src="http://opensource.org/trademarks/open_source_button.png" style="width:88px;height:31px" /></a>
        <a href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=222420&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
        </td>
        <td align="right" style="border:0px;vertical-align:top">
        <a href="http://winrun4j.sourceforge.net/"><img border="0" alt="WinRun4J - Configurable Java Launcher for Windows" src="others/winrun4j.gif"/></a>
        <a href="http://xlloop.sourceforge.net/"><img border="0" alt="XLLoop - Excel Functions in Java, Javascript, Ruby, Python, Erlang" src="others/xlloop.gif"/></a>
        <a href="http://variantcodec.sourceforge.net/"><img border="0" alt="VariantCodec - Generic Data Structure Serialization Library for Java" src="others/variantcodec.gif"/></a>
        <a href="http://jvst.sourceforge.net/"><img border="0" alt="JVST - VST Interface for Java" src="others/jvst.gif"/></a>
        <a href="http://jxll.sourceforge.net/"><img border="0" alt="JXLL - Excel Addin Interaction Library" src="others/jxll.gif"/></a>
        <a href="http://expr4j.sourceforge.net/"><img border="0" alt="Expr4J - Expression Calculation Engine for Java" src="others/expr4j.gif"/></a>
        </td>
        </tr>
        </table>
    </div>
</body>
<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://apps.sourceforge.net/piwik/xlloop/" : "http://apps.sourceforge.net/piwik/xlloop/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
piwik_action_name = '';
piwik_idsite = 1;
piwik_url = pkBaseURL + "piwik.php";
piwik_log(piwik_action_name, piwik_idsite, piwik_url);
</script>
<object><noscript><p><img src="http://apps.sourceforge.net/piwik/xlloop/piwik.php?idsite=1" alt="piwik"/></p></noscript></object>
<!-- End Piwik Tag -->
</html>